---
title: "Project A1 : Fungal invasion of the Apple fruit"
author: "Auriane Cozic, Thibault de La Taille, Eloi Littner, Audrey Menaesse"
date: "March 20, 2020"
output: 
  pdf_document:
    df_print: paged
geometry: margin=2.5cm
fontsize: 12pt
df_print: paged
---




## Internal questions 
 
- Is radius the radius of the apple ? If yes, how do you interpret the fact that the Fungal Radial Advance is bigger than the size of the apple ?
-> (Auriane) Yes I think it is the radius of the apple. It is usually not bigger than the radial fungal advance if you look line by line, except for line 18 and 21. And I am not sure how to explain it either...

```{r}
data[,5]>data[,6]
```


#Import and loading data

```{r, echo=FALSE}
#Load libraries and packages
```


```{r}
data <-read.table("http://users.stat.ufl.edu/~winner/data/apple1.dat")
colnames(data) <- c("variety", "strain", "days", "weight", "radius", "fungal radial advance", "rate of advance")
data
```

# Data description


Description : This data set is used to describe the fungal invasion of 5 varieties of apple by 7 different fusarium strains.  

Variables/names :


Questions : We are interested in comparing
  - the infecting power depending on the conditions of infection (strain of fungi, day of infection, temperature)
  - the resistance to invasion of different varieties of apples, and their characteristics (weight, radius)
  
# Exploratory data analysis 

```{r}
str(data)

data$variety <- as.factor(data$variety)
data$strain <- as.factor(data$strain)

summary(data)
```
Different plots to illustrate the data :
```{r}
plot(data$strain,data$`rate of advance`)
plot(data$variety,data$`rate of advance`)
plot(data$days,data$`rate of advance`)
plot(data$strain, data$`fungal radial advance`)
plot(data$variety, data$`fungal radial advance`)
plot(data$days, data$`fungal radial advance`)
```


## Fungal radial advance dependencies

Here, we want to observe the rate of advance of the fungal invasion depending on the fusarium strain and the variety of apple. 

```{r}
plot.design(x=data$`fungal radial advance`~.,data=data[,c(1,2,6)], ylab= 'Fungal radial advance')
plot.design(x=data$`fungal radial advance`~.,data=data[,c(1,2,6)], ylab= 'Fungal radial advance', fun=sd)


```

2 strains seem very less virulent (2 & 3 corresponding to strains B)
Variance is very dependent on the variety : variety 3 has especially high sd


```{r}
boxplot(data$`fungal radial advance`~data$days, ylab='Fungal radial advance')
```


```{r}
plot(data$weight, data$`fungal radial advance`)
plot(data$radius, data$`fungal radial advance`)
```


## Rate of advance


```{r}
tapply(data$`rate of advance`, list(data$strain, data$variety), mean)
```


```{r}
plot.design(x=data$`rate of advance`~.,data=data[,c(1,2,7)], ylab= 'Rate of fungal advance')
plot.design(x=data$`rate of advance`~.,data=data[,c(1,2,7)], ylab= 'Rate of fungal advance', fun =sd)

```

The strain part is similar to fungal radius.
Same tendencies also far variety, however, more marked here. Also, variety 2 is a little less virulent and 5 more (significant ? don't think so).

Variety 3 has still a very higher sd
Otherwise, less variance differences

Now we want to compare the rate of advance with the number of days

```{r}
tapply(data$`rate of advance`, list(data$strain, data$days), mean)
```

```{r}
boxplot(data$`rate of advance`~data$days, ylab='Fungal rate of advance')
```

The rate of advance seem inversly correlated to the day of infection !
Also we can see one oulier :

```{r}
data[17,]
```


```{r}
plot(data$weight, data$`rate of advance`)
plot(data$radius, data$`rate of advance`)
```


#Model selection

Definition of the different linear models

```{r}
fit.s = lm(`rate of advance` ~ strain, data=data)
fit.sv = lm(`rate of advance` ~ strain+variety, data=data)
fit.svd = lm (`rate of advance` ~ strain+variety+days, data=data)
fit.svdw = lm (`rate of advance` ~ strain+variety+days+weight, data=data)
fit.svdwr = lm (`rate of advance` ~ strain+variety+days+weight+radius, data=data)

```

Comparing the different models with anova method :
```{r}
anova(fit.s, fit.sv)
```
